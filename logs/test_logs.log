INFO:__main__:2024-03-10 14:54:09 ================= Test ETL ================= 
INFO:src.etl:2024-03-10 14:54:09 Starting to extract data from CSV files...
INFO:src.etl:2024-03-10 14:54:09 Extracting file: data/test_data/test_products1.csv
INFO:src.etl:2024-03-10 14:54:09 Extracting file: data/test_data/test_products2.csv
INFO:src.etl:2024-03-10 14:54:09 Data extraction done! Total files extracted: 2
INFO:__main__:2024-03-10 14:54:09 :Test ETL Pipeline: Extracted data: [['19', '1', 'Dress', 'Adidas', "Men's Fashion", '40', '1.04315921083618', 'Black', 'XL'], ['97', '2', 'Shoes', 'H&M', "Women's Fashion", '82', '4.02641627114191', 'Black', 'L'], ['25', '3', 'Dress', 'Adidas', "Women's Fashion", '44', '3.33793755937705', 'Yellow', 'XL'], ['57', '4', 'Shoes', 'Zara', "Men's Fashion", '23', '1.04952295631285', 'White', 'S'], ['79', '5', 'T-shirt', 'Adidas', "Men's Fashion", '79', '4.30277340839868', 'Black', 'M'], ['98', '6', 'Dress', 'Adidas', "Men's Fashion", '47', '1.37956573953305', 'Yellow', 'L'], ['16', '7', 'Jeans', 'Gucci', "Men's Fashion", '37', '1.35675037468426', 'White', 'XL'], ['26', '26', 'Dress', 'Gucci', "Women's Fashion", '21', '4.74816900503964', 'Green', 'S'], ['82', '27', 'T-shirt', 'Adidas', "Kids' Fashion", '72', '3.30174340837541', 'Red', 'L'], ['87', '28', 'Shoes', 'Zara', "Women's Fashion", '32', '2.82280285980225', 'Yellow', 'L'], ['98', '29', 'Shoes', 'Gucci', "Women's Fashion", '85', '4.94098522098686', 'Yellow', 'M'], ['20', '30', 'Sweater', 'Nike', "Kids' Fashion", '99', '3.11011357258146', 'Green', 'XL'], ['36', '31', 'Jeans', 'H&M', "Kids' Fashion", '37', '2.75518714870577', 'Blue', 'S'], ['98', '32', 'T-shirt', 'Nike', "Kids' Fashion", '78', '3.4472894702795', 'White', 'XL'], ['69', '33', 'Jeans', 'H&M', "Kids' Fashion", '89', '4.79940901870971', 'Green', 'XL'], ['31', '34', 'Jeans', 'H&M', "Men's Fashion", '80', '3.92326115977123', 'Black', 'S']]
INFO:src.etl:2024-03-10 14:54:09 Starting to transform data...
INFO:src.etl:2024-03-10 14:54:09 Data Transformation done !
INFO:__main__:2024-03-10 14:54:09 :Test ETL Pipeline: Transform data: [{'product_id': 1, 'user_id': 19, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 40.0, 'rating': 1.04, 'color': 'Black', 'size': 'XL'}, {'product_id': 2, 'user_id': 97, 'product_name': 'Shoes', 'brand': 'H&M', 'category': "Women's Fashion", 'price': 82.0, 'rating': 4.03, 'color': 'Black', 'size': 'L'}, {'product_id': 3, 'user_id': 25, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Women's Fashion", 'price': 44.0, 'rating': 3.34, 'color': 'Yellow', 'size': 'XL'}, {'product_id': 4, 'user_id': 57, 'product_name': 'Shoes', 'brand': 'Zara', 'category': "Men's Fashion", 'price': 23.0, 'rating': 1.05, 'color': 'White', 'size': 'S'}, {'product_id': 5, 'user_id': 79, 'product_name': 'T-shirt', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 79.0, 'rating': 4.3, 'color': 'Black', 'size': 'M'}, {'product_id': 6, 'user_id': 98, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 47.0, 'rating': 1.38, 'color': 'Yellow', 'size': 'L'}, {'product_id': 7, 'user_id': 16, 'product_name': 'Jeans', 'brand': 'Gucci', 'category': "Men's Fashion", 'price': 37.0, 'rating': 1.36, 'color': 'White', 'size': 'XL'}, {'product_id': 26, 'user_id': 26, 'product_name': 'Dress', 'brand': 'Gucci', 'category': "Women's Fashion", 'price': 21.0, 'rating': 4.75, 'color': 'Green', 'size': 'S'}, {'product_id': 27, 'user_id': 82, 'product_name': 'T-shirt', 'brand': 'Adidas', 'category': "Kids' Fashion", 'price': 72.0, 'rating': 3.3, 'color': 'Red', 'size': 'L'}, {'product_id': 28, 'user_id': 87, 'product_name': 'Shoes', 'brand': 'Zara', 'category': "Women's Fashion", 'price': 32.0, 'rating': 2.82, 'color': 'Yellow', 'size': 'L'}, {'product_id': 29, 'user_id': 98, 'product_name': 'Shoes', 'brand': 'Gucci', 'category': "Women's Fashion", 'price': 85.0, 'rating': 4.94, 'color': 'Yellow', 'size': 'M'}, {'product_id': 30, 'user_id': 20, 'product_name': 'Sweater', 'brand': 'Nike', 'category': "Kids' Fashion", 'price': 99.0, 'rating': 3.11, 'color': 'Green', 'size': 'XL'}, {'product_id': 31, 'user_id': 36, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Kids' Fashion", 'price': 37.0, 'rating': 2.76, 'color': 'Blue', 'size': 'S'}, {'product_id': 32, 'user_id': 98, 'product_name': 'T-shirt', 'brand': 'Nike', 'category': "Kids' Fashion", 'price': 78.0, 'rating': 3.45, 'color': 'White', 'size': 'XL'}, {'product_id': 33, 'user_id': 69, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Kids' Fashion", 'price': 89.0, 'rating': 4.8, 'color': 'Green', 'size': 'XL'}, {'product_id': 34, 'user_id': 31, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Men's Fashion", 'price': 80.0, 'rating': 3.92, 'color': 'Black', 'size': 'S'}]
INFO:src.etl:2024-03-10 14:54:09 Starting to ingest data...
INFO:src.etl:Product with ID 1 already exists. Updating record...
INFO:src.etl:Product with ID 2 already exists. Updating record...
INFO:src.etl:Product with ID 3 already exists. Updating record...
INFO:src.etl:Product with ID 4 already exists. Updating record...
INFO:src.etl:Product with ID 5 already exists. Updating record...
INFO:src.etl:Product with ID 6 already exists. Updating record...
INFO:src.etl:Product with ID 7 already exists. Updating record...
INFO:src.etl:Product with ID 26 already exists. Updating record...
INFO:src.etl:Product with ID 27 already exists. Updating record...
INFO:src.etl:Product with ID 28 already exists. Updating record...
INFO:src.etl:Product with ID 29 already exists. Updating record...
INFO:src.etl:Product with ID 30 already exists. Updating record...
INFO:src.etl:Product with ID 31 already exists. Updating record...
INFO:src.etl:Product with ID 32 already exists. Updating record...
INFO:src.etl:Product with ID 33 already exists. Updating record...
INFO:src.etl:Product with ID 34 already exists. Updating record...
INFO:src.etl:2024-03-10 14:54:09 Data ingested successfully!
INFO:__main__:2024-03-10 14:54:09 :Test ETL Pipeline: Ingest data: [{'product_id': 1, 'user_id': 19, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 40.0, 'rating': 1.04, 'color': 'Black', 'size': 'XL'}, {'product_id': 2, 'user_id': 97, 'product_name': 'Shoes', 'brand': 'H&M', 'category': "Women's Fashion", 'price': 82.0, 'rating': 4.03, 'color': 'Black', 'size': 'L'}, {'product_id': 3, 'user_id': 25, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Women's Fashion", 'price': 44.0, 'rating': 3.34, 'color': 'Yellow', 'size': 'XL'}, {'product_id': 4, 'user_id': 57, 'product_name': 'Shoes', 'brand': 'Zara', 'category': "Men's Fashion", 'price': 23.0, 'rating': 1.05, 'color': 'White', 'size': 'S'}, {'product_id': 5, 'user_id': 79, 'product_name': 'T-shirt', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 79.0, 'rating': 4.3, 'color': 'Black', 'size': 'M'}, {'product_id': 6, 'user_id': 98, 'product_name': 'Dress', 'brand': 'Adidas', 'category': "Men's Fashion", 'price': 47.0, 'rating': 1.38, 'color': 'Yellow', 'size': 'L'}, {'product_id': 7, 'user_id': 16, 'product_name': 'Jeans', 'brand': 'Gucci', 'category': "Men's Fashion", 'price': 37.0, 'rating': 1.36, 'color': 'White', 'size': 'XL'}, {'product_id': 26, 'user_id': 26, 'product_name': 'Dress', 'brand': 'Gucci', 'category': "Women's Fashion", 'price': 21.0, 'rating': 4.75, 'color': 'Green', 'size': 'S'}, {'product_id': 27, 'user_id': 82, 'product_name': 'T-shirt', 'brand': 'Adidas', 'category': "Kids' Fashion", 'price': 72.0, 'rating': 3.3, 'color': 'Red', 'size': 'L'}, {'product_id': 28, 'user_id': 87, 'product_name': 'Shoes', 'brand': 'Zara', 'category': "Women's Fashion", 'price': 32.0, 'rating': 2.82, 'color': 'Yellow', 'size': 'L'}, {'product_id': 29, 'user_id': 98, 'product_name': 'Shoes', 'brand': 'Gucci', 'category': "Women's Fashion", 'price': 85.0, 'rating': 4.94, 'color': 'Yellow', 'size': 'M'}, {'product_id': 30, 'user_id': 20, 'product_name': 'Sweater', 'brand': 'Nike', 'category': "Kids' Fashion", 'price': 99.0, 'rating': 3.11, 'color': 'Green', 'size': 'XL'}, {'product_id': 31, 'user_id': 36, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Kids' Fashion", 'price': 37.0, 'rating': 2.76, 'color': 'Blue', 'size': 'S'}, {'product_id': 32, 'user_id': 98, 'product_name': 'T-shirt', 'brand': 'Nike', 'category': "Kids' Fashion", 'price': 78.0, 'rating': 3.45, 'color': 'White', 'size': 'XL'}, {'product_id': 33, 'user_id': 69, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Kids' Fashion", 'price': 89.0, 'rating': 4.8, 'color': 'Green', 'size': 'XL'}, {'product_id': 34, 'user_id': 31, 'product_name': 'Jeans', 'brand': 'H&M', 'category': "Men's Fashion", 'price': 80.0, 'rating': 3.92, 'color': 'Black', 'size': 'S'}]
INFO:__main__:2024-03-10 14:54:09 :Test ETL Pipeline: Database file exists: True
INFO:__main__:2024-03-10 14:54:09 : Test ETL Pipeline: Check Data Quality Done
INFO:__main__:
 2024-03-10 14:54:09 ================= Test Flask App ================= 
INFO:src.flask_api:2024-03-10 14:54:09 Starting Flask App ...
INFO:src.flask_api:2024-03-10 14:54:09 get the first 10 products from db ...
INFO:src.flask_api:2024-03-10 14:54:09 showing the first 10 products
INFO:__main__:Test Flask App: Response Status Code: 200
INFO:__main__:Test Flask App: status code: 200
INFO:__main__:Test Flask App: response is a non-empty list: 200
